#include <stdint.h>
#include <stdio.h>

int main(void)
{
    // 1. Enable clock for GPIOA
    uint32_t *PResi = (uint32_t*)0x4002104C;
    *PResi |= (1 << 0);  // Enable clock for GPIOA (set bit 0)

    // 2. Configure PA1 as output
    uint32_t *PMode = (uint32_t*)0x48000000;
    *PMode &= ~(3 << 2);  // Clear mode bits 2 and 3 for PA1
    *PMode |= (1 << 2);   // Set PA1 to output mode (01)

    // 3. ODR and IDR pointers
    uint32_t *POut = (uint32_t*)0x48000014;  // ODR (output data register)
    uint32_t *PIn = (uint32_t*)0x48000010;   // IDR (input data register)

    // Main loop
    while(1)
    {
        // Read PA0 input state
        uint8_t in = (uint8_t)(*PIn & 0x1);  // Check the state of PA0

        if(in )
        {
            *POut |= (1 << 1);  // Set PA1 high (turn LED on)
        }
        else
        {
            *POut &= ~(1 << 1);  // Set PA1 low (turn LED off)
        }
    }
}
